<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>25电赛A题满分方案解析 - Zhu Wenguan&#039;s Blog</title><link rel="manifest" href="/blog/manifest.json"><meta name="application-name" content="Zhu Wenguan"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Zhu Wenguan"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="前言 博主参加2025年电赛A题——能量回馈的变流器负载试验装置，达成了题目所有指标，在此分享整个方案设计。"><meta property="og:type" content="blog"><meta property="og:title" content="25电赛A题满分方案解析"><meta property="og:url" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/"><meta property="og:site_name" content="Zhu Wenguan&#039;s Blog"><meta property="og:description" content="前言 博主参加2025年电赛A题——能量回馈的变流器负载试验装置，达成了题目所有指标，在此分享整个方案设计。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/3da3664d0780fc56c99cf3d59a6b309c.jpg"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image.png"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-10.png"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-1.png"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-2.png"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-3.png"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-4.png"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-6.png"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-7.png"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-8.png"><meta property="og:image" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-9.png"><meta property="article:published_time" content="2025-08-08T13:51:40.000Z"><meta property="article:modified_time" content="2026-01-05T06:12:23.710Z"><meta property="article:author" content="Zhu Wenguan"><meta property="article:tag" content="电赛"><meta property="article:tag" content="电源"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/3da3664d0780fc56c99cf3d59a6b309c.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/"},"headline":"25电赛A题满分方案解析","image":["https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/3da3664d0780fc56c99cf3d59a6b309c.jpg","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image.png","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-10.png","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-1.png","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-2.png","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-3.png","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-4.png","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-6.png","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-7.png","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-8.png","https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-9.png"],"datePublished":"2025-08-08T13:51:40.000Z","dateModified":"2026-01-05T06:12:23.710Z","author":{"@type":"Person","name":"Zhu Wenguan"},"publisher":{"@type":"Organization","name":"Zhu Wenguan's Blog","logo":{"@type":"ImageObject","url":{"text":"Zhu's Blog Site"}}},"description":"前言 博主参加2025年电赛A题——能量回馈的变流器负载试验装置，达成了题目所有指标，在此分享整个方案设计。"}</script><link rel="canonical" href="https://zhuwenguan.github.io/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/6.0.0/css/all.min.css"><link data-pjax rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/blog/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/blog/">Zhu&#039;s Blog Site</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/blog/">主页</a><a class="navbar-item" href="/blog/archives">归档</a><a class="navbar-item" href="/blog/categories">分类</a><a class="navbar-item" href="/blog/tags">标签</a><a class="navbar-item" href="/blog/about">关于</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2025-08-08T13:51:40.000Z" title="8/8/2025, 9:51:40 PM">2025-08-08</time>发表</span><span class="level-item"><a class="link-muted" href="/blog/categories/%E9%A1%B9%E7%9B%AE/">项目</a></span></div></div><h1 class="title is-3 is-size-4-mobile">25电赛A题满分方案解析</h1><div class="content"><h2 id="前言"><a class="markdownIt-Anchor" href="#前言"></a> 前言</h2>
<p>博主参加2025年电赛A题——能量回馈的变流器负载试验装置，达成了题目所有指标，在此分享整个方案设计。</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/3da3664d0780fc56c99cf3d59a6b309c.jpg" class="">
<span id="more"></span>
<h2 id="题目解析"><a class="markdownIt-Anchor" href="#题目解析"></a> 题目解析</h2>
<h3 id="1-原题再现"><a class="markdownIt-Anchor" href="#1-原题再现"></a> 1. 原题再现</h3>
<p>设计并制作一个能量回馈的变流器负载试验装置（简称试验装置），其结构如图1 所示。变流器负载试验时，受试变流器1（DC-AC）将直流电变为交流电，其输出通过连接单元与变流器2（AC-DC）相连，变流器2 将交流电转换成直流电，并回馈至变流器1 的输入端，与直流电源共同给变流器1 供电，从而实现节能。</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image.png" class="">
<h3 id="2-题设要求"><a class="markdownIt-Anchor" href="#2-题设要求"></a> 2. 题设要求</h3>
<h4 id="基本要求"><a class="markdownIt-Anchor" href="#基本要求"></a> 基本要求</h4>
<ol>
<li>变流器1 能输出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>f</mi><mn>1</mn></msub><mo>=</mo><mn>50</mn><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">f_1=50Hz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>、线电压<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>1</mn></msub><mo>=</mo><mn>32</mn><mi>V</mi><mo>±</mo><mn>0.25</mn><mi>V</mi></mrow><annotation encoding="application/x-tex">U_1=32V±0.25V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">5</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>、额定线电流<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn><mi>A</mi></mrow><annotation encoding="application/x-tex">I_1=2A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal">A</span></span></span></span> 的三相对称正弦交流电。</li>
<li>在基本要求（1）的工作条件下，要求输出交流电压总谐波畸变率（THD）不大于2%。</li>
<li>变流器1 输出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>50</mn><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">50Hz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>1</mn></msub><mo>=</mo><mn>32</mn><mi>V</mi><mo>±</mo><mn>0.25</mn><mi>V</mi></mrow><annotation encoding="application/x-tex">U_1=32V±0.25V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">5</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>的三相交流电，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">I_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>在0A~2A 间变化时，要求负载调整率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mrow><mi>I</mi><mn>1</mn></mrow></msub><mo>≤</mo><mn>0.3</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">S_{I1}≤0.3\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07847em;">I</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.80556em;vertical-align:-0.05556em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">3</span><span class="mord">%</span></span></span></span>。</li>
<li>要求变流器1 输出交流电的频率范围为20Hz~100Hz，步进1Hz。</li>
</ol>
<h4 id="发挥部分"><a class="markdownIt-Anchor" href="#发挥部分"></a> 发挥部分</h4>
<p>按图1 进行测试。</p>
<ol>
<li>试验装置能实现能量回馈，要求变流器1输出电流<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">I_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>不小于1A。</li>
<li>变流器1 输出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>50</mn><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">50Hz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mn>1</mn></msub><mo>=</mo><mn>32</mn><mi>V</mi><mo>±</mo><mn>0.25</mn><mi>V</mi></mrow><annotation encoding="application/x-tex">U_1=32V±0.25V</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">±</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">2</span><span class="mord">5</span><span class="mord mathnormal" style="margin-right:0.22222em;">V</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn><mi>A</mi></mrow><annotation encoding="application/x-tex">I_1 = 2A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord mathnormal">A</span></span></span></span>，要求直流电源输出功率Pd=IdUd越小越好。</li>
<li>其他。</li>
</ol>
<h3 id="3-题目工程背景"><a class="markdownIt-Anchor" href="#3-题目工程背景"></a> 3. 题目工程背景</h3>
<p>从我自己的理解来看，这套题目并非空穴来风，而是有很强的工程实践意义的。三相电在生活当中常用于电机驱动，而三相逆变器、电机两个东西放到一起，最容易想到的就是新能源汽车。电动汽车的电源来自于一块大号锂电池，也就是一个直流电源。但是电动汽车的电机需要三相交流电才能驱动。因此，每一台电动汽车，本质上都是一台三相逆变器。这就与题目的变流器1——DC-AC三相逆变器相呼应。<br />
其次题目的核心功能——“能量回馈”功能，与电动汽车的“动能回收”功能，有着丝丝缕缕的联系。电动汽车的电机在输入机械能时，也就变成了一个发电机，将机械能转变为电能。驱动电机需要三相电，电机发电得到的自然也是三相电，这就与题目中的变流器2相呼应，将三相电转变为直流电。<br />
题目中，特别提到了“连接单元”这一模块，表面上，是连接逆变器、馈流器、电阻负载之间的连接单元，实际上，也可以指代电动汽车中，电机产生的机械能，返回到电机并发电产生电能，这一过程所使用的连接器、传动装置等。再者，题目所要求的变频功能，也对应着三相电机通过变频改变转速的功能。<br />
总的来说，这一个题目，是新能源汽车电能变换全流程的缩影。</p>
<h2 id="方案概述"><a class="markdownIt-Anchor" href="#方案概述"></a> 方案概述</h2>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-10.png" class="">
<h3 id="三相逆变器设计"><a class="markdownIt-Anchor" href="#三相逆变器设计"></a> 三相逆变器设计</h3>
<h4 id="1-硬件设计"><a class="markdownIt-Anchor" href="#1-硬件设计"></a> 1. 硬件设计</h4>
<p>三相逆变器拓扑结构就是三个半桥顶底相连，中心引出三相电。通过电感和电容组成的LC滤波器将开关过程产生的谐波过滤掉，保留50Hz的工频交流电。</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-1.png" class="">
<p>我所设计的三相逆变器采用三个IR2104半桥驱动芯片驱动六颗MOSFET，每颗IR2104都能自动产生两路互补PWM波形，单片机只需要给出高侧MOS管PWM波形，IR2104自动将其反向并添加死区，给到下管。类似于IR2104的芯片都可以使用，能够有效节省单片机的PWM资源。不过对于STM32的TIM1和TIM8来说并不重要，其具有反相输出功能，不需要额外工作。</p>
<h4 id="2-spwm原理"><a class="markdownIt-Anchor" href="#2-spwm原理"></a> 2. SPWM原理</h4>
<p>SPWM传统上是用一个正弦波与三角波进行比较，得到一系列占空比变化的PWM波形。正弦波幅值与三角波幅值的比值即为调制比。<br />
这里分析一下调制比与SPWM的关系，进而得到调制比与输出电压的关系。首先，如果调制比很高，比如2.0，那么意味着正弦波有很长一段时间始终高于三角波，就会导致输出一段时间的高电平，而且占空比整体都比较高。如果调制比很低，那么正弦波的幅值永远低于三角波，则不会出现某一个PWM周期的占空比为100%，占空比整体都比较低。<br />
如果PWM占空比高，按照DC-DC的经验，输出电压就会高。结合刚才的分析，调制比高的时候，占空比整体高，则输出电压高，调制比低，则输出电压低。因此，我们通过调整SPWM的调制比，就可以改变输出电压的幅值。</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-2.png" class="">
<h4 id="3-电压计算"><a class="markdownIt-Anchor" href="#3-电压计算"></a> 3. 电压计算</h4>
<p>考虑调制比为1.0的一列SPWM波，忽略开关损耗、导通损耗，假设LC滤波器为理想滤波器。<br />
每一半桥的输出电压幅值</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>U</mi><mi>m</mi></msub><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><msub><mi>U</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">U_m=\frac{1}{2}U_d
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">U_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为相电压幅值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mi>d</mi></msub></mrow><annotation encoding="application/x-tex">U_d</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为直流电压。<br />
取其中两相电压做差，有以下关系：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>u</mi><mi>A</mi></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>U</mi><mi>m</mi></msub><mo>∗</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>u</mi><mi>B</mi></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>U</mi><mi>m</mi></msub><mo>∗</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi><mo>+</mo><mfrac><mn>2</mn><mn>3</mn></mfrac><mi>π</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>u</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mo>=</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>u</mi><mi>A</mi></msub><mo>−</mo><msub><mi>u</mi><mi>B</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mo lspace="0em" rspace="0em">=</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msqrt><mn>3</mn></msqrt><msub><mi>U</mi><mi>m</mi></msub><mo>∗</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi><mo>+</mo><mfrac><mn>1</mn><mn>6</mn></mfrac><mi>π</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
u_A=&amp;U_m*\cos(2\pi ft)\\
u_B=&amp;U_m*\cos(2\pi ft + \frac{2}{3}\pi)\\
u_{AB}=&amp;u_A-u_B\\
=&amp;\sqrt{3}U_m*\cos(2\pi ft+\frac{1}{6}\pi)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.614880000000001em;vertical-align:-3.5574400000000015em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.05744em;"><span style="top:-6.53888em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-4.557439999999999em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-2.7314399999999988em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-0.7499999999999986em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mrel">=</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5574400000000015em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.05744em;"><span style="top:-6.53888em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span><span style="top:-4.557439999999999em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mclose">)</span></span></span><span style="top:-2.7314399999999988em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.7499999999999986em;"><span class="pstrut" style="height:3.32144em;"></span><span class="mord"><span class="mord"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.956095em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">3</span></span></span><span style="top:-2.916095em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.08390500000000001em;"><span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">6</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5574400000000015em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>A</mi></msub></mrow><annotation encoding="application/x-tex">u_A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">u_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为相电压，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为线电压。</p>
<blockquote>
<p>小写<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span>为瞬时值，大写<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi></mrow><annotation encoding="application/x-tex">U</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span></span></span></span>为有效值，下同。</p>
</blockquote>
<p>因此，线电压<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub></mrow><annotation encoding="application/x-tex">u_{AB}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>的电压幅值为相电压幅值的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msqrt><mn>3</mn></msqrt></mrow><annotation encoding="application/x-tex">\sqrt{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.13278em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">3</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span></span></span></span>倍，即直流电压的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msqrt><mn>3</mn></msqrt><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{\sqrt{3}}{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3829999999999998em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0379999999999998em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.3990085em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord sqrt mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.912845em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mtight" style="padding-left:0.833em;"><span class="mord mtight">3</span></span></span><span style="top:-2.872845em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail mtight" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.12715500000000002em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>倍。进而，线电压有效值</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><menclose notation="box"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="false"><mstyle scriptlevel="0" displaystyle="true"><mrow><msub><mi>U</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mo>=</mo><mfrac><msqrt><mn>6</mn></msqrt><mn>4</mn></mfrac><msub><mi>U</mi><mi>d</mi></msub><mo>≈</mo><mn>0.6123</mn><msub><mi>U</mi><mi>d</mi></msub></mrow></mstyle></mstyle></mstyle></menclose></mrow><annotation encoding="application/x-tex">\boxed{U_{AB}=\frac{\sqrt{6}}{4}U_d\approx0.6123U_d}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.95022em;vertical-align:-1.0259999999999998em;"></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.92422em;"><span style="top:-4.95022em;"><span class="pstrut" style="height:4.95022em;"></span><span class="boxpad"><span class="mord"><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">A</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5842200000000002em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.90722em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord">6</span></span></span><span style="top:-2.86722em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z'/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.13278em;"><span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">6</span><span class="mord">1</span><span class="mord">2</span><span class="mord">3</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.92422em;"><span class="pstrut" style="height:4.95022em;"></span><span class="stretchy fbox" style="height:2.95022em;border-style:solid;border-width:0.04em;"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0259999999999998em;"><span></span></span></span></span></span></span></span></span></span></p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/341029717">推导过程参考此处</a><br />
有了这个数据，就可以推导出直流电源供电电压。题目没有规定这一电压，可以按照我们的需求自由选择。32V线电压逆推出直流电压为52.26V。为了保险，同时也考虑到各处带来的损耗，我们最终选择58V直流电压输入。</p>
<h4 id="4-软件设计"><a class="markdownIt-Anchor" href="#4-软件设计"></a> 4. 软件设计</h4>
<p>本方案采用STM32F429ZIT6 Dicovery开发板为主控。逆变器软件主要功能包括：</p>
<ol>
<li>SPWM波形产生</li>
<li>输出电压、电流采样</li>
<li>PID闭环调控</li>
<li>可控变频</li>
</ol>
<p>下面分别解析各个功能如何产生。</p>
<h5 id="spwm波形产生"><a class="markdownIt-Anchor" href="#spwm波形产生"></a> SPWM波形产生</h5>
<p>传统方法产生SPWM波，是将三角波与正弦波进行比较，得到高低电平。这个方法应用在单片机上并不合适。更简单高效的方法是，通过数学计算，得出每一个周期的SPWM占空比，存储到内存里面，实时更新占空比即可。<br />
下面推导SPWM的计算公式。本质上，SPWM就是一个占空比随正弦变化规律变化的PWM波形。当时间位于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mi>T</mi><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{T}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>的整数倍时，正弦波幅度为1，对应SPWM占空比为100%，反之，当时间位于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>3</mn><mi>T</mi></mrow><mn>4</mn></mfrac></mrow><annotation encoding="application/x-tex">\frac{3T}{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.217331em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.872331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">4</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>的整数倍时，正弦波幅度为-1，对应占空比为0%。通过这个关系，可以得到如下公式</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>u</mi><mi>t</mi><mi>y</mi><mo>=</mo><mi>k</mi><mo>∗</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>f</mi><mi>t</mi><mo>+</mo><msub><mi>ϕ</mi><mn>0</mn></msub><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">duty=k*\frac{1}{2}(\cos(2\pi ft+\phi_0)+1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">ϕ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span>为调制比。验证一下，如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">k=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>u</mi><mi>t</mi><mi>y</mi></mrow><annotation encoding="application/x-tex">duty</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>在一段时间内大于1，且上升较快，占空比整体较高，反之亦然。与先前的分析一致。<br />
单片机内，很难对当前时间进行精准的测量。更便捷的方法是用SPWM表格的索引值作为时间的指代物。</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>d</mi><mi>u</mi><mi>t</mi><mi>y</mi><mo>=</mo><mi>k</mi><mo>∗</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo stretchy="false">(</mo><mi>cos</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>2</mn><mi>π</mi><mi>f</mi><mfrac><mrow><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi></mrow><mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow></mfrac><mo>+</mo><mi>ϕ</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">duty=k*\frac{1}{2}(\cos(2\pi f\frac{index}{size}+\phi)+1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">d</span><span class="mord mathnormal">u</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mop">cos</span><span class="mopen">(</span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">e</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">ϕ</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">e</span></span></span></span>是一个周期SPWM占空比表格的大小。<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">index</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span></span></span></span>是表格索引。例如，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">index=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>时，计算出来的占空比就是第1个周期的占空比。这里着重分析一下<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">e</span></span></span></span>。SPWM表格内存储一个周期的所有占空比，那么，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">e</span></span></span></span>就是一个正弦周期时间内，PWM的周期数，数值上等于载波比（PWM频率与正弦频率的比值）。例如PWM频率为50kHz，输出50Hz工频交流电，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">size</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mord mathnormal">e</span></span></span></span>为1000。<br />
单片机计算SPWM表格的代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">uint16_t</span>* <span class="built_in">array</span>;         <span class="comment">// SPWM占空比表格数组指针</span></span><br><span class="line">    <span class="type">uint32_t</span> size;           <span class="comment">// 表格大小（一个周期内PWM周期数）</span></span><br><span class="line">    <span class="type">uint32_t</span> max_value;      <span class="comment">// PWM最大计数值（对应100%占空比）</span></span><br><span class="line">    <span class="type">float</span> phase;             <span class="comment">// 相位偏移</span></span><br><span class="line">    <span class="type">uint32_t</span> update_max_value; <span class="comment">// 占空比更新的最大值</span></span><br><span class="line">&#125; SPWM_HandleTypeDef;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SPWM_Init</span><span class="params">(SPWM_HandleTypeDef* hspwm, <span class="type">uint32_t</span> max_value, <span class="type">uint32_t</span> freq, <span class="type">float</span> phase)</span></span><br><span class="line">&#123;</span><br><span class="line">    hspwm-&gt;size = PWM_FREQ / freq; <span class="comment">// 计算表格大小</span></span><br><span class="line">    <span class="type">uint32_t</span> size = hspwm-&gt;size;</span><br><span class="line">    hspwm-&gt;<span class="built_in">array</span> = (<span class="type">uint16_t</span>*)<span class="built_in">malloc</span>((PWM_FREQ / <span class="number">20</span>) * <span class="keyword">sizeof</span>(<span class="type">uint16_t</span>)); <span class="comment">// 分配内存</span></span><br><span class="line">    hspwm-&gt;max_value = max_value;</span><br><span class="line">    hspwm-&gt;phase = phase;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">uint32_t</span> min = <span class="number">0.01</span> * max_value; <span class="comment">// 占空比下限</span></span><br><span class="line">        <span class="type">uint32_t</span> max = <span class="number">0.99</span> * max_value; <span class="comment">// 占空比上限</span></span><br><span class="line">        <span class="comment">// 计算SPWM占空比，正弦调制</span></span><br><span class="line">        <span class="type">uint32_t</span> temp = max_value * (<span class="number">0.5f</span> - <span class="number">0.5f</span> * arm_cos_f32(<span class="number">2.0f</span> * PI * i / size + phase * <span class="number">2</span> * PI));</span><br><span class="line">        <span class="keyword">if</span> (temp &gt; max)</span><br><span class="line">            temp = max; <span class="comment">// 限制最大值</span></span><br><span class="line">        <span class="keyword">if</span> (temp &lt; min)</span><br><span class="line">            temp = min; <span class="comment">// 限制最小值</span></span><br><span class="line">        hspwm-&gt;<span class="built_in">array</span>[i] = temp; <span class="comment">// 存入表格</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这串代码的缺点是使用了<code>malloc</code>函数动态分配内存。STM32的<code>malloc</code>会把这段内存分配到堆（heap）当中去，导致在STM32CubeMX生成代码时，必须手动增大堆大小。我最终增大到了0x8000，也就是32kB的堆大小，非常占用内存。<br />
计算好SPWM表格后，借助STM32的定时器，可以直接产生PWM波形。为了能够实时更新占空比，传统做法是在定时器更新中断里面，手动更改CCR的值。这种方法需要中断主函数运行，占用CPU资源。考虑到SPWM表格并不会频繁变化，使用DMA持续搬运数据到定时器是个更好的办法。DMA设定如图。</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-3.png" class="">
<p>需要特别注意的是，一定要记得修改DMA方向。默认方向是P2M，我们需要M2P。此外要把模式改为Circular。<br />
为了实现SPWM波形的实时更新，我额外添加了一个更新函数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">extern</span> SPWM_HandleTypeDef hspwm_u, hspwm_v, hspwm_w;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SPWM_UpdateStart</span><span class="params">(<span class="type">uint32_t</span> update_max_value, <span class="type">uint32_t</span> updateFreq)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(updateFlag == <span class="number">1</span>)</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	</span><br><span class="line">	hspwm_u.update_max_value = update_max_value;</span><br><span class="line">	hspwm_u.size = PWM_FREQ / updateFreq;</span><br><span class="line">	hspwm_v.update_max_value = update_max_value;</span><br><span class="line">	hspwm_v.size = PWM_FREQ / updateFreq;</span><br><span class="line">	hspwm_w.update_max_value = update_max_value;</span><br><span class="line">	hspwm_w.size = PWM_FREQ / updateFreq;</span><br><span class="line">	updateFlag = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">SPWM_Update</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(updateFlag == <span class="number">0</span>)</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">	<span class="comment">// 更新三个相的SPWM波形</span></span><br><span class="line">	SPWM_HandleTypeDef* handles[<span class="number">3</span>] = &#123;&amp;hspwm_u, &amp;hspwm_v, &amp;hspwm_w&#125;;</span><br><span class="line">	<span class="type">float</span> phases[<span class="number">3</span>] = &#123;hspwm_u.phase, hspwm_v.phase, hspwm_w.phase&#125;;</span><br><span class="line">	<span class="type">static</span> <span class="type">uint32_t</span> lastFreq = <span class="number">50</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> h = <span class="number">0</span>; h &lt; <span class="number">3</span>; h++) &#123;</span><br><span class="line">		SPWM_HandleTypeDef* hspwm = handles[h];</span><br><span class="line">		<span class="type">uint32_t</span> size = hspwm-&gt;size;</span><br><span class="line">		<span class="type">uint32_t</span> max_value = hspwm-&gt;update_max_value;</span><br><span class="line">		<span class="type">float</span> phase = phases[h];</span><br><span class="line">		<span class="keyword">if</span> (hspwm-&gt;<span class="built_in">array</span> == <span class="literal">NULL</span>) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">			<span class="type">uint32_t</span> min = <span class="number">0.01</span> * max_value;</span><br><span class="line">			<span class="type">uint32_t</span> max = <span class="number">0.99</span> * max_value;</span><br><span class="line">			<span class="type">uint32_t</span> temp = max_value * (<span class="number">0.5f</span> - <span class="number">0.5f</span> * arm_cos_f32(<span class="number">2.0f</span> * PI * i / size + phase * <span class="number">2</span> * PI));</span><br><span class="line">			<span class="keyword">if</span>(temp &gt; max)</span><br><span class="line">				temp = max;</span><br><span class="line">			<span class="keyword">if</span>(temp &lt; min)</span><br><span class="line">				temp = min;</span><br><span class="line">			hspwm-&gt;<span class="built_in">array</span>[i] = temp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(lastFreq != freq)</span><br><span class="line">	&#123;</span><br><span class="line">		HAL_TIM_PWM_Stop_DMA(&amp;htim1, TIM_CHANNEL_1);</span><br><span class="line">		HAL_TIM_PWM_Stop_DMA(&amp;htim1, TIM_CHANNEL_2);</span><br><span class="line">		HAL_TIM_PWM_Stop_DMA(&amp;htim1, TIM_CHANNEL_3);</span><br><span class="line">		HAL_Delay(<span class="number">1</span>);</span><br><span class="line">		HAL_TIM_PWM_Start_DMA(&amp;htim1, TIM_CHANNEL_1, (<span class="type">uint32_t</span>*)hspwm_u.<span class="built_in">array</span>, hspwm_u.size);</span><br><span class="line">		HAL_TIM_PWM_Start_DMA(&amp;htim1, TIM_CHANNEL_2, (<span class="type">uint32_t</span>*)hspwm_v.<span class="built_in">array</span>, hspwm_v.size);</span><br><span class="line">		HAL_TIM_PWM_Start_DMA(&amp;htim1, TIM_CHANNEL_3, (<span class="type">uint32_t</span>*)hspwm_w.<span class="built_in">array</span>, hspwm_w.size);</span><br><span class="line">	&#125;</span><br><span class="line">	lastFreq = freq;</span><br><span class="line">	updateFlag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这一段代码主要是重新计算SPWM表格，和维护SPWM句柄结构体。其中需要注意的是。在主函数中循环调用<code>SPWM_Update()</code>，在需要的时候，调用<code>SPWM_UpdateStart()</code>，就可以高效率修改SPWM表格，并重新输出。SPWM的更新，会导致表格长度发生变化，因为输出的正弦波频率有可能改变，即题目要求的变频功能，因此需要修改DMA长度，重新启动TIM输出。需要注意的是，重新启动TIM输出时，如果不调用<code>HAL_TIM_PWM_Stop_DMA()</code>函数，直接调用<code>HAL_TIM_PWM_Start_DMA()</code>函数来更新DMA大小，是不可行的。因为如果DMA处在Busy状态，调用Start函数不会有任何效果。</p>
<h5 id="可控变频"><a class="markdownIt-Anchor" href="#可控变频"></a> 可控变频</h5>
<p>只要前面SPWM写得好，可控变频其实并不难。变频只需要改变前面占空比公式中的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span>，重新计算一遍即可，唯一需要考虑的问题是数组长度。如前所述，SPWM表格长度等于载波频率与正弦波频率之比，因此，<code>malloc()</code>能够分配的数组长度，需要满足频率最小时的长度，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><msub><mi>f</mi><mrow><mi>P</mi><mi>W</mi><mi>M</mi></mrow></msub><mrow><mn>20</mn><mi>H</mi><mi>z</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{f_{PWM}}{20Hz}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.277216em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9322159999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">0</span><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.446108em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3567071428571427em;margin-left:-0.10764em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">P</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="mord mathnormal mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.14329285714285717em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></p>
<h5 id="交流电压-电流采样"><a class="markdownIt-Anchor" href="#交流电压-电流采样"></a> 交流电压、电流采样</h5>
<p>首先，电压电流采样的数据来源于我们设计的电压、电流互感器采样模块。这个模块会输出一个以1/2VCC为中心上下波动的电压波形，表征被测电压/电流的大小。单片机通过ADC采样该电压，换算即可得到实际输出电压/电流。难点在于：</p>
<ol>
<li>如何消除直流分量</li>
<li>如何校准采样过程的误差</li>
</ol>
<p>第一个问题看似简单，采样数据减去2047不就可以了？当然不。12位ADC采样的电压精度可以达到1mV以下，如果单纯的减去2047，表面上相当于减去了1/2VCC，实际上，由于单片机的VCC与采样模块的VCC存在些许偏差，同样是3V，单片机可能是2.95，采样模块可能是3.02，单片机减去2047并没有把采样模块输出电压的直流偏置完全减去。此外，采样模块的1/2VCC，是由电源电压分压得到。分压电阻的大小也可能有些许误差，致使直流偏置量并不是严格的1/2VCC。综合来看，各个地方电压的误差，累计起来，在ADC采样数据身上，会产生很大的误差，单纯的减去2047是无法消除直流分量的。由于我们后面还要计算RMS有效值，任何直流分量都会很大的影响RMS计算结果。因此，必须用更加准确的方法去除直流分量。<br />
借助arm_dsp库中的<code>arm_biquad_cascade_df2T_f32()</code>函数，可以快速计算二阶差分方程组成的IIR高通/低通滤波器。这里我们使用一个一阶IIR高通滤波器过滤掉直流分量。其差分方程如下：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo>=</mo><mi>x</mi><mo stretchy="false">[</mo><mi>n</mi><mo stretchy="false">]</mo><mo>−</mo><mi>x</mi><mo stretchy="false">[</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>+</mo><mi>α</mi><mo>⋅</mo><mi>y</mi><mo stretchy="false">[</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">y[n]=x[n]-x[n-1]+\alpha\cdot y[n-1]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">x</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.44445em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mopen">[</span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span></span></p>
<p>该差分方程是一个一阶高通滤波器。截止频率计算公式如下：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mi>c</mi><mo>≈</mo><mfrac><mrow><mrow><mo fence="true">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo fence="true">)</mo></mrow><mo>⋅</mo><msub><mi>f</mi><mi>s</mi></msub></mrow><mrow><mn>2</mn><mi>π</mi></mrow></mfrac><mi>f</mi><mi>c</mi></mrow><annotation encoding="application/x-tex">fc\approx\frac{\left(1-\alpha\right)\cdot f_s}{2\pi}fc
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.03588em;">π</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">c</span></span></span></span></span></p>
<p>代入<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.995</mn></mrow><annotation encoding="application/x-tex">\alpha=0.995</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">9</span><span class="mord">9</span><span class="mord">5</span></span></span></span>，若<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>s</mi><mo>=</mo><mn>1000</mn><mtext> </mtext><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">fs=1000\ Hz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace"> </span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>，求得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>c</mi><mo>≈</mo><mn>0.796</mn><mi>H</mi><mi>z</mi></mrow><annotation encoding="application/x-tex">fc≈0.796 Hz</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord">.</span><span class="mord">7</span><span class="mord">9</span><span class="mord">6</span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span>。</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-4.png" class="">
<p>其幅频响应和相频响应如图。可以看出，其对低频信号的影响较大，对20Hz以上的信号基本没有影响。能够满足题目20-100Hz的变频范围需求。<br />
ADC采样的数据，通过下面这个函数计算成有效值：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">float</span> <span class="title function_">RMS</span><span class="params">(<span class="type">uint16_t</span>* buffer, <span class="type">uint32_t</span> size)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">float</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="type">float</span> volt;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        volt = buffer[i] * <span class="number">2.985f</span> / <span class="number">4095</span> / <span class="number">0.0214238f</span>;</span><br><span class="line">        arm_biquad_cascade_df2T_f32(&amp;dcBlocker, &amp;volt, &amp;volt, <span class="number">1</span>);</span><br><span class="line">        sum += volt * volt;</span><br><span class="line">    &#125;</span><br><span class="line">    sum = sqrtf(sum / size);</span><br><span class="line">    <span class="keyword">return</span> sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二个问题，如何校准采样数据呢？<br />
在实际系统中，理论设定值（Target）和实际测量值（Real）之间往往存在系统误差，例如硬件精度、温漂、非线性等。<br />
为了获得准确的实际输出，我们需要根据测得的校准数据，对设定值进行补偿。实际应用中，我们很容易测量出设定值与实际值的数据点，例如：</p>
<table>
<thead>
<tr>
<th style="text-align:center">Target（设定）</th>
<th style="text-align:center">Real（实际）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1.00</td>
<td style="text-align:center">2.84</td>
</tr>
<tr>
<td style="text-align:center">2.00</td>
<td style="text-align:center">4.93</td>
</tr>
<tr>
<td style="text-align:center">3.00</td>
<td style="text-align:center">6.33</td>
</tr>
<tr>
<td style="text-align:center">4.00</td>
<td style="text-align:center">7.31</td>
</tr>
<tr>
<td style="text-align:center">5.00</td>
<td style="text-align:center">8.01</td>
</tr>
<tr>
<td style="text-align:center">6.00</td>
<td style="text-align:center">8.50</td>
</tr>
<tr>
<td style="text-align:center">7.00</td>
<td style="text-align:center">8.88</td>
</tr>
<tr>
<td style="text-align:center">8.00</td>
<td style="text-align:center">9.16</td>
</tr>
<tr>
<td style="text-align:center">9.00</td>
<td style="text-align:center">9.38</td>
</tr>
</tbody>
</table>
<p>如果我们想得到实际输出=3.0V，直接设定Target=3.0V会导致输出电压为6.33V。为了得到真正的3.0V，我们需要将设定值调整到大约1.1V。这就是这套校准理论的核心。</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-6.png" class="">
<p>左侧的图是传统思维画出的输出曲线，他代表了不同的设定值下，输出值的变化。但这不是我们想要的。我们需要的实际上是这个函数的反函数，也就是右侧的图。可以看到，如果我输入x=6，y=2.76，也就是说，我想要实际输出电压为6时，设定电压应当为2.76，因此，我只要构建出右侧的函数曲线，即可实现目标值与实际值的校准。<br />
这里我专门写了一个校准用的库，可以用在各个项目里面，将理论值与实际值建立起一个函数关系，然后用实际值逆推出理论值，实现校准功能。<br />
这块主要是AI写的代码，我只是提供了思路。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">Calibration_Init</span><span class="params">(Calibration_HandleTypeDef* cali, <span class="type">const</span> <span class="type">float</span>* target, <span class="type">const</span> <span class="type">float</span>* real, <span class="type">uint32_t</span> length)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (length &lt; <span class="number">2</span> || target == <span class="literal">NULL</span> || real == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="comment">// Handle invalid input</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Initialize the calibration structure</span></span><br><span class="line">    cali-&gt;target = target;</span><br><span class="line">    cali-&gt;real = real;</span><br><span class="line">    cali-&gt;length = length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Allocate memory for k and b arrays</span></span><br><span class="line">    cali-&gt;k = (<span class="type">float</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">float</span>) * (length - <span class="number">1</span>));</span><br><span class="line">    cali-&gt;b = (<span class="type">float</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">float</span>) * (length - <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cali-&gt;k == <span class="literal">NULL</span> || cali-&gt;b == <span class="literal">NULL</span>) </span><br><span class="line">    &#123; </span><br><span class="line">        <span class="comment">// Handle memory allocation failure</span></span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate segments</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; cali-&gt;length - <span class="number">1</span>; i++) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">float</span> x0 = cali-&gt;real[i];</span><br><span class="line">        <span class="type">float</span> x1 = cali-&gt;real[i+<span class="number">1</span>];</span><br><span class="line">        <span class="type">float</span> y0 = cali-&gt;target[i];</span><br><span class="line">        <span class="type">float</span> y1 = cali-&gt;target[i+<span class="number">1</span>];</span><br><span class="line">        cali-&gt;k[i] = (y1 - y0) / (x1 - x0);</span><br><span class="line">        cali-&gt;b[i] = y0 - cali-&gt;k[i] * x0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">float</span> <span class="title function_">Calibration_Apply</span><span class="params">(Calibration_HandleTypeDef* cali, <span class="type">float</span> real_value)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// Overflow and underflow checks</span></span><br><span class="line">    <span class="keyword">if</span> (real_value &lt;= cali-&gt;real[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">return</span> cali-&gt;k[<span class="number">0</span>] * real_value + cali-&gt;b[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">if</span> (real_value &gt;= cali-&gt;real[cali-&gt;length - <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">return</span> cali-&gt;k[cali-&gt;length - <span class="number">2</span>] * real_value + cali-&gt;b[cali-&gt;length - <span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Find the segment for the given real_value</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">uint32_t</span> i = <span class="number">0</span>; i &lt; cali-&gt;length - <span class="number">1</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (real_value &gt;= cali-&gt;real[i] &amp;&amp; real_value &lt;= cali-&gt;real[i+<span class="number">1</span>]) &#123;</span><br><span class="line">            <span class="keyword">return</span> cali-&gt;k[i] * real_value + cali-&gt;b[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// In case no segment found, return an error value or handle it appropriately</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="pid闭环调节"><a class="markdownIt-Anchor" href="#pid闭环调节"></a> PID闭环调节</h5>
<p>PID属于老生常谈的问题了。需要注意的是，为了更加稳定的调节输出电压，我使用了增量式PID控制器，实时调控SPWM的调制比，从而控制输出电压。PID我也写成了一个库，各个项目都能用，直接看代码即可。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="type">float</span> Kp;  <span class="comment">// Proportional gain</span></span><br><span class="line">    <span class="type">float</span> Ki;  <span class="comment">// Integral gain</span></span><br><span class="line">    <span class="type">float</span> Kd;  <span class="comment">// Derivative gain</span></span><br><span class="line">    <span class="type">float</span> target; <span class="comment">// Desired value</span></span><br><span class="line">    <span class="type">float</span> integral; <span class="comment">// Integral term</span></span><br><span class="line">    <span class="type">float</span> integral_limit; <span class="comment">// Limit for integral term to prevent windup</span></span><br><span class="line">    <span class="type">float</span> previous_error; <span class="comment">// Previous error for derivative calculation</span></span><br><span class="line">    <span class="type">float</span> prev_prev_error;</span><br><span class="line">&#125; PID_HandleTypeDef;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PID_Init</span><span class="params">(PID_HandleTypeDef *pid, <span class="type">float</span> kp, <span class="type">float</span> ki, <span class="type">float</span> kd, <span class="type">float</span> integral_limit)</span></span><br><span class="line">&#123;</span><br><span class="line">    pid-&gt;Kp = kp;</span><br><span class="line">    pid-&gt;Ki = ki;</span><br><span class="line">    pid-&gt;Kd = kd;</span><br><span class="line">    pid-&gt;previous_error = <span class="number">0.0f</span>;</span><br><span class="line">    pid-&gt;integral = <span class="number">0.0f</span>;</span><br><span class="line">    pid-&gt;integral_limit = integral_limit;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PID_SetTarget</span><span class="params">(PID_HandleTypeDef *pid, <span class="type">float</span> target)</span></span><br><span class="line">&#123;</span><br><span class="line">    pid-&gt;target = target;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PID_Reset</span><span class="params">(PID_HandleTypeDef *pid)</span></span><br><span class="line">&#123;</span><br><span class="line">    pid-&gt;integral = <span class="number">0.0f</span>;</span><br><span class="line">    pid-&gt;previous_error = <span class="number">0.0f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PID_Compute</span><span class="params">(PID_HandleTypeDef *pid, <span class="type">float</span> current_value, <span class="type">float</span> *output)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">float</span> error = pid-&gt;target - current_value;</span><br><span class="line">    pid-&gt;integral += error;</span><br><span class="line">    <span class="comment">// Limit integral to prevent windup</span></span><br><span class="line">    <span class="keyword">if</span> (pid-&gt;integral &gt; pid-&gt;integral_limit) &#123;</span><br><span class="line">        pid-&gt;integral = pid-&gt;integral_limit;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (pid-&gt;integral &lt; -pid-&gt;integral_limit) &#123;</span><br><span class="line">        pid-&gt;integral = -pid-&gt;integral_limit;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">float</span> derivative = error - pid-&gt;previous_error;</span><br><span class="line">    *output = pid-&gt;Kp * error + pid-&gt;Ki * pid-&gt;integral + pid-&gt;Kd * derivative;</span><br><span class="line">    pid-&gt;previous_error = error;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">PID_ComputeIncremental</span><span class="params">(PID_HandleTypeDef *pid, <span class="type">float</span> current_value, <span class="type">float</span> *output)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">float</span> error = pid-&gt;target - current_value;</span><br><span class="line">    <span class="type">float</span> delta_output = pid-&gt;Kp * (error - pid-&gt;previous_error)</span><br><span class="line">                        + pid-&gt;Ki * error</span><br><span class="line">                        + pid-&gt;Kd * (error - <span class="number">2</span> * pid-&gt;previous_error + pid-&gt;prev_prev_error);</span><br><span class="line">    *output += delta_output;</span><br><span class="line">    pid-&gt;prev_prev_error = pid-&gt;previous_error;</span><br><span class="line">    pid-&gt;previous_error = error;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>至此，三相逆变器的设计就介绍完了。</p>
<h3 id="电压电流采样模块设计"><a class="markdownIt-Anchor" href="#电压电流采样模块设计"></a> 电压电流采样模块设计</h3>
<p>该模块来源于立创开源广场，<a target="_blank" rel="noopener" href="https://oshwhub.com/824366a/voltage-current-transformer">开源连接</a>，做了部分修改。</p>
<h4 id="1-互感器电路设计"><a class="markdownIt-Anchor" href="#1-互感器电路设计"></a> 1. 互感器电路设计</h4>
<p>电压电流采样都是用互感器隔离采样的，但是电压和电流不能选择同样的互感器。电压互感器是并联在电路中的，流过的电流应当很小（内阻很大），而电流互感器是串联在电路中的，有可能流过很大的电流。所有的互感器都是将电流按比例感应到次级，因此电压互感器，流过小电流，应当有很小的电流互感比。电流互感器，流过大电流，应当有很大的互感比，使得次级电流很小。同时，次级必须有I-V转换电路（一个电阻或者一个跨阻放大器）将电流信号转变为电压信号。</p>
<h4 id="2-放大电路设计"><a class="markdownIt-Anchor" href="#2-放大电路设计"></a> 2. 放大电路设计</h4>
<p>放大电路主要负责：将电流信号转变为电压信号、抬升至1/2VCC、放大一定的倍数。这块电路很简单，参考开源链接即可。</p>
<h3 id="馈流电路设计"><a class="markdownIt-Anchor" href="#馈流电路设计"></a> 馈流电路设计</h3>
<h4 id="1-理论分析"><a class="markdownIt-Anchor" href="#1-理论分析"></a> 1. 理论分析</h4>
<p>按照题目要求，需要将三相交流电变流送回直流输入端，实现能量回馈的功能。那么，如果馈流电路接入直流输入端，就会形成两路直流电源并联的情况，此时，必须有一方以电流源的形式输出，否则会因为微小的电压差异灌入大电流。因此，馈流电路的基本思路就确定了，是一个恒流输出的直流电源，输入三相交流电，输出恒流直流电。</p>
<h4 id="2-拓扑选择"><a class="markdownIt-Anchor" href="#2-拓扑选择"></a> 2. 拓扑选择</h4>
<p>首先，三相交流电转直流电，有很多种办法，最简单的就是二极管整流电路。</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-7.png" class="">
<p>这样整流得到的电压是固定的，如果交流线电压为32V的话，整流输出电压大约为46V。显然，经过逆变-整流的操作，直流电压相比于输入的时候明显下降了。因此想要将能量输送回去，需要升压。<br />
升压拓扑有很多种，常用的无非就是Boost电路和反激电路。二者最大区别在于隔离/非隔离。我们逆变出的相电压，实际上是以电源地为参考的，而线电压是相电压的差，事实上也是以电源地为参考的，并不是浮地的，因此整流出来的电压，也是以电源地为参考的，并不是浮地或者有高共模电压的。综合来看，这个升压不需要隔离拓扑就可以，因此我们选择Boost拓扑作为馈流电路的主拓扑</p>
<h4 id="3-方案设计"><a class="markdownIt-Anchor" href="#3-方案设计"></a> 3. 方案设计</h4>
<p>整流电路刚才已经介绍过了，使用最基本的二极管整流就可以。不过，二极管整流会导致效率下降，馈流之后的直流电源输出电流偏高，馈流效率较低。我们做方案的时候并没有太考虑效率的问题，于是就使用了最简单的方案。<br />
Boost电路我们设计了两种方案，一种是数控双向DC-DC、PID恒流，另一种是采用L6561芯片搭建的恒流控制电路。</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-8.png" class="">
<p>L6561虽然是一个PFC控制芯片，但是只要将MULT引脚接入直流电平，而不是接入交流参考波形，就可以当作一个普通的恒流控制芯片使用。因为实验室这款芯片有很多，而且工作起来比较稳定，就选择了这个芯片做控制。<br />
数控方案我们使用预先设计好的双向DC-DC模块制作的，模块集成了双向的电流采样、电压采样、半桥驱动等。回馈效果也很好，但是一旦接入，单片机计算量就太大了，因此放弃了数控方案。下面是双向DC-DC的原理图</p>
<img src="/blog/2025/08/08/25%E7%94%B5%E8%B5%9BA%E9%A2%98%E6%BB%A1%E5%88%86%E6%96%B9%E6%A1%88%E8%A7%A3%E6%9E%90/image-9.png" class="">
<h3 id="连接单元"><a class="markdownIt-Anchor" href="#连接单元"></a> 连接单元</h3>
<p>题目当中的连接单元，只在发挥部分有提到，是三相逆变和三相整流之间的连接。在这个题目中，按照我的理解，这个连接单元就是三根导线，将逆变出来的三相电接入整流电路，因此并不存在什么连接单元的说法。<br />
我将连接单元的概念扩展到了基础部分，设计成了一个基础部分与扩展部分的切换单元，使用一个三路双控开关，公共端接入逆变器输出，一端接入馈流单元，另一端接入三相电阻负载，这样如果开关打到上端，就将逆变器接入馈流单元，打到下端就接入三相负载。</p>
<h3 id="作品接线"><a class="markdownIt-Anchor" href="#作品接线"></a> 作品接线</h3>
<p>由于我们没有设计自己的开发板，使用的成品开发板，开发板的IO口都是由杜邦线引出的。众所周知，杜邦线在电赛当中百害而无利，需要尽可能避免。为了能将开发板的IO口牢牢的引出，我们在一块洞洞板上焊接杜邦母座，整个开发板插入，在洞洞板边缘焊接好需要的接插件（主要包括XH2.54接口和KF2EDG15K系列5.08mm的接插件），形成一个“转接板”，接插件与杜邦母座连接好线，接插件就可以随意连接到其他模块上。模拟信号全部用SMA连接器，在洞洞板上将SMA焊接好后，引线连接到IO口母座的位置，就可以连接进单片机。这样，既不破坏单片机开发板，又能够随时根据需要调整IO口引出，适应不同的赛题和作品，不需要更换单片机开发板，只需要更换一个转接板即可。</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>25电赛A题满分方案解析</p><p><a href="https://zhuwenguan.github.io/blog/2025/08/08/25电赛A题满分方案解析/">https://zhuwenguan.github.io/blog/2025/08/08/25电赛A题满分方案解析/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Zhu Wenguan</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2025-08-08</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2026-01-05</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/blog/tags/%E7%94%B5%E8%B5%9B/">电赛</a><a class="link-muted mr-2" rel="tag" href="/blog/tags/%E7%94%B5%E6%BA%90/">电源</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/blog/2025/09/05/CarSim%E4%BB%BF%E7%9C%9F%E5%9F%BA%E7%A1%80/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">CarSim仿真基础</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/blog/2025/06/07/%E4%BF%A1%E5%8F%B7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E5%A4%8D%E4%B9%A0%E8%B5%84%E6%96%99/"><span class="level-item">信号与系统复习资料</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#前言"><span class="level-left"><span class="level-item">1</span><span class="level-item"> 前言</span></span></a></li><li><a class="level is-mobile" href="#题目解析"><span class="level-left"><span class="level-item">2</span><span class="level-item"> 题目解析</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-原题再现"><span class="level-left"><span class="level-item">2.1</span><span class="level-item"> 1. 原题再现</span></span></a></li><li><a class="level is-mobile" href="#2-题设要求"><span class="level-left"><span class="level-item">2.2</span><span class="level-item"> 2. 题设要求</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#基本要求"><span class="level-left"><span class="level-item">2.2.1</span><span class="level-item"> 基本要求</span></span></a></li><li><a class="level is-mobile" href="#发挥部分"><span class="level-left"><span class="level-item">2.2.2</span><span class="level-item"> 发挥部分</span></span></a></li></ul></li><li><a class="level is-mobile" href="#3-题目工程背景"><span class="level-left"><span class="level-item">2.3</span><span class="level-item"> 3. 题目工程背景</span></span></a></li></ul></li><li><a class="level is-mobile" href="#方案概述"><span class="level-left"><span class="level-item">3</span><span class="level-item"> 方案概述</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#三相逆变器设计"><span class="level-left"><span class="level-item">3.1</span><span class="level-item"> 三相逆变器设计</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-硬件设计"><span class="level-left"><span class="level-item">3.1.1</span><span class="level-item"> 1. 硬件设计</span></span></a></li><li><a class="level is-mobile" href="#2-spwm原理"><span class="level-left"><span class="level-item">3.1.2</span><span class="level-item"> 2. SPWM原理</span></span></a></li><li><a class="level is-mobile" href="#3-电压计算"><span class="level-left"><span class="level-item">3.1.3</span><span class="level-item"> 3. 电压计算</span></span></a></li><li><a class="level is-mobile" href="#4-软件设计"><span class="level-left"><span class="level-item">3.1.4</span><span class="level-item"> 4. 软件设计</span></span></a></li></ul></li><li><a class="level is-mobile" href="#电压电流采样模块设计"><span class="level-left"><span class="level-item">3.2</span><span class="level-item"> 电压电流采样模块设计</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-互感器电路设计"><span class="level-left"><span class="level-item">3.2.1</span><span class="level-item"> 1. 互感器电路设计</span></span></a></li><li><a class="level is-mobile" href="#2-放大电路设计"><span class="level-left"><span class="level-item">3.2.2</span><span class="level-item"> 2. 放大电路设计</span></span></a></li></ul></li><li><a class="level is-mobile" href="#馈流电路设计"><span class="level-left"><span class="level-item">3.3</span><span class="level-item"> 馈流电路设计</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#1-理论分析"><span class="level-left"><span class="level-item">3.3.1</span><span class="level-item"> 1. 理论分析</span></span></a></li><li><a class="level is-mobile" href="#2-拓扑选择"><span class="level-left"><span class="level-item">3.3.2</span><span class="level-item"> 2. 拓扑选择</span></span></a></li><li><a class="level is-mobile" href="#3-方案设计"><span class="level-left"><span class="level-item">3.3.3</span><span class="level-item"> 3. 方案设计</span></span></a></li></ul></li><li><a class="level is-mobile" href="#连接单元"><span class="level-left"><span class="level-item">3.4</span><span class="level-item"> 连接单元</span></span></a></li><li><a class="level is-mobile" href="#作品接线"><span class="level-left"><span class="level-item">3.5</span><span class="level-item"> 作品接线</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/blog/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/blog/categories/Verilog/"><span class="level-start"><span class="level-item">Verilog</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/%E4%BB%BF%E7%9C%9F/"><span class="level-start"><span class="level-item">仿真</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/"><span class="level-start"><span class="level-item">嵌入式</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/%E7%A1%AC%E4%BB%B6/"><span class="level-start"><span class="level-item">硬件</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/%E7%BD%91%E7%BB%9C/"><span class="level-start"><span class="level-item">网络</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/%E8%AF%BE%E4%B8%9A/"><span class="level-start"><span class="level-item">课业</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/%E8%B5%9B%E8%BD%A6/"><span class="level-start"><span class="level-item">赛车</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/%E8%BD%AF%E4%BB%B6/"><span class="level-start"><span class="level-item">软件</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/blog/categories/%E9%A1%B9%E7%9B%AE/"><span class="level-start"><span class="level-item">项目</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-12-28T15:29:18.000Z">2025-12-28</time></p><p class="title"><a href="/blog/2025/12/28/STM32-TouchGFX-FMC%E9%A9%B1%E5%8A%A88080%E5%B9%B6%E5%8F%A3LCD%E5%B1%8F%E5%B9%95%E7%9A%84%E9%82%A3%E4%BA%9B%E5%9D%91/">STM32+TouchGFX+FMC驱动8080并口LCD屏幕的那些坑</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-12-01T04:50:25.000Z">2025-12-01</time></p><p class="title"><a href="/blog/2025/12/01/TCS%E7%AE%97%E6%B3%95%E8%BF%AD%E4%BB%A3%E6%9B%B4%E6%96%B0/">TCS算法迭代更新</a></p><p class="categories"><a href="/blog/categories/%E8%B5%9B%E8%BD%A6/">赛车</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-11-17T02:15:20.000Z">2025-11-17</time></p><p class="title"><a href="/blog/2025/11/17/%E7%AD%94%E8%BE%A9%E5%87%86%E5%A4%87/">FSEC2025控制答辩</a></p><p class="categories"><a href="/blog/categories/%E8%B5%9B%E8%BD%A6/">赛车</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-10-27T02:15:20.000Z">2025-10-27</time></p><p class="title"><a href="/blog/2025/10/27/%E5%BE%AE%E6%9C%BA%E5%8E%9F%E7%90%86%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/">微机原理课程笔记</a></p><p class="categories"><a href="/blog/categories/%E8%AF%BE%E4%B8%9A/">课业</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-10-15T05:24:53.000Z">2025-10-15</time></p><p class="title"><a href="/blog/2025/10/15/u8g2%20mui%E8%BF%9B%E9%98%B6%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/">u8g2 mui进阶使用方法</a></p><p class="categories"><a href="/blog/categories/%E5%B5%8C%E5%85%A5%E5%BC%8F/">嵌入式</a></p></div></article></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/blog/">Zhu&#039;s Blog Site</a><p class="is-size-7"><span>&copy; 2026 Zhu Wenguan</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/blog/js/column.js"></script><script src="/blog/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/blog/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/katex.min.css"><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/katex.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/contrib/auto-render.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/KaTeX/0.15.1/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script src="https://cdnjs.loli.net/ajax/libs/pjax/0.2.8/pjax.min.js"></script><script src="/blog/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/blog/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script data-pjax src="/blog/js/insight.js" defer></script><script data-pjax>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/blog/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>